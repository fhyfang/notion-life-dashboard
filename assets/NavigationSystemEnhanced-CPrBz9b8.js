import{j as e,m as S}from"./motion-Nujmgg1Y.js";import{r as g}from"./vendor-DJ1oPbzn.js";import{g as P,r as ee}from"./dataLoader-oWN11X4O.js";import{T as se,R as re}from"./icons-CYvmV9N1.js";const oe=()=>{const[N,E]=g.useState([]),[y,G]=g.useState([]),[D,J]=g.useState(0),[_,O]=g.useState(0),[A,Q]=g.useState(0),[U,V]=g.useState(!0),[C,R]=g.useState(null),[W,X]=g.useState(0);g.useEffect(()=>{(async()=>{try{R(null),console.log("å¼€å§‹èŽ·å–ä»·å€¼è§‚æ•°æ®...");const r=await P("ä»·å€¼è§‚");if(console.log("ä»·å€¼è§‚åŽŸå§‹æ•°æ®:",r),Array.isArray(r)){console.log("ä»·å€¼è§‚æ•°æ®æ˜¯æ•°ç»„ï¼Œé•¿åº¦:",r.length);const x=r.filter(s=>{var i,l,n,o,d,u,p;try{const h=((n=(l=(i=s==null?void 0:s.properties)==null?void 0:i.ä¼˜å…ˆçº§)==null?void 0:l.select)==null?void 0:n.name)||"0åˆ†",f=parseInt(h.replace("åˆ†",""));return console.log("ä»·å€¼è§‚é¡¹ç›®:",(p=(u=(d=(o=s==null?void 0:s.properties)==null?void 0:o.ä»·å€¼è§‚åç§°)==null?void 0:d.title)==null?void 0:u[0])==null?void 0:p.plain_text,"ä¼˜å…ˆçº§:",f),f>=4}catch(h){return console.warn("Error filtering value item:",s,h),!1}}).map(s=>{var i,l,n,o,d,u,p,h,f,b,v,w,I;try{const j={name:((o=(n=(l=(i=s==null?void 0:s.properties)==null?void 0:i.ä»·å€¼è§‚åç§°)==null?void 0:l.title)==null?void 0:n[0])==null?void 0:o.plain_text)||"æœªå‘½å",description:((h=(p=(u=(d=s==null?void 0:s.properties)==null?void 0:d["æ­£é¢è¡Œä¸º (Do's)"])==null?void 0:u.rich_text)==null?void 0:p[0])==null?void 0:h.plain_text)||"",priority:parseInt(((w=(v=(b=(f=s==null?void 0:s.properties)==null?void 0:f.ä¼˜å…ˆçº§)==null?void 0:b.select)==null?void 0:v.name)==null?void 0:w.replace("åˆ†",""))||"0"),icon:((I=s==null?void 0:s.icon)==null?void 0:I.emoji)||"â­"};return console.log("å¤„ç†åŽçš„ä»·å€¼è§‚é¡¹ç›®:",j),j}catch(j){return console.warn("Error processing value item:",s,j),null}}).filter(s=>s!==null);console.log("æœ€ç»ˆæ ¸å¿ƒä»·å€¼è§‚:",x),E(x)}else console.warn("Values data is not an array:",r),E([]);console.log("å¼€å§‹èŽ·å–ç›®æ ‡æ•°æ®...");const t=await P("ç›®æ ‡åº“");console.log("ç›®æ ‡åº“åŽŸå§‹æ•°æ®:",t);const c=await P("é¡¹ç›®åº“");console.log("é¡¹ç›®åº“åŽŸå§‹æ•°æ®:",c);const $=new Map;if(Array.isArray(c)&&c.forEach(x=>{var l,n,o,d;const s=x==null?void 0:x.id,i=((d=(o=(n=(l=x==null?void 0:x.properties)==null?void 0:l.é¡¹ç›®åç§°)==null?void 0:n.title)==null?void 0:o[0])==null?void 0:d.plain_text)||"æœªå‘½åé¡¹ç›®";s&&$.set(s,i)}),Array.isArray(t)){console.log("ç›®æ ‡æ•°æ®æ˜¯æ•°ç»„ï¼Œé•¿åº¦:",t.length);const x=t.filter(s=>{var i,l,n,o;try{return((o=(n=(l=(i=s==null?void 0:s.properties)==null?void 0:i.ç†æƒ³çŠ¶æ€)==null?void 0:l.title)==null?void 0:n[0])==null?void 0:o.plain_text)&&!(s!=null&&s.archived)}catch(d){return console.warn("Error filtering goal item:",s,d),!1}}).slice(0,4).map(s=>{var i,l,n,o,d,u,p,h,f,b,v,w,I,j,H,L,K,M,T,B,q;try{const Z=(((n=(l=(i=s==null?void 0:s.properties)==null?void 0:i.å…³è”é¡¹ç›®)==null?void 0:l.relation)==null?void 0:n.map(k=>k.id))||[]).map(k=>$.get(k)).filter(Boolean),m=((u=(d=(o=s==null?void 0:s.properties)==null?void 0:o.é¢†åŸŸ)==null?void 0:d.select)==null?void 0:u.name)||"æœªåˆ†ç±»";console.log("ç›®æ ‡é¢†åŸŸ:",m);const F={name:(((b=(f=(h=(p=s==null?void 0:s.properties)==null?void 0:p.ç†æƒ³çŠ¶æ€)==null?void 0:h.title)==null?void 0:f[0])==null?void 0:b.plain_text)||"æœªå‘½åç›®æ ‡").replace(/\n/g,"").trim(),linkedValues:((I=(w=(v=s==null?void 0:s.properties)==null?void 0:v.å…³è”ä»·å€¼è§‚)==null?void 0:w.relation)==null?void 0:I.map(k=>k.id))||[],progress:((L=(H=(j=s==null?void 0:s.properties)==null?void 0:j.ç›®æ ‡è¿›åº¦)==null?void 0:H.rollup)==null?void 0:L.number)||0,weeklyHours:((M=(K=s==null?void 0:s.properties)==null?void 0:K.æ¯å‘¨æŠ•å…¥æ—¶é—´)==null?void 0:M.number)||0,deadline:((q=(B=(T=s==null?void 0:s.properties)==null?void 0:T.æˆªæ­¢æ—¥æœŸ)==null?void 0:B.date)==null?void 0:q.start)||"",status:"è¿›è¡Œä¸­",category:m==="èŒä¸šå‘å±•"||m==="æŠ€èƒ½æå‡"||m==="è´¢åŠ¡ç®¡ç†"?"å®‰å…¨å»ºæž„æ ¸":"ç”Ÿå‘½æ»‹å…»æ ¸",linkedProjects:Z};return console.log("å¤„ç†åŽçš„ç›®æ ‡:",F),F}catch(z){return console.warn("Error processing goal item:",s,z),null}}).filter(s=>s!==null);console.log("æœ€ç»ˆç›®æ ‡åˆ—è¡¨:",x),G(x)}else console.warn("Goals data is not an array:",t),G([])}catch(r){console.error("Error fetching navigation data:",r),R("æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥æˆ–åˆ·æ–°é¡µé¢é‡è¯•"),E([]),G([])}finally{V(!1)}})()},[W]),g.useEffect(()=>{if(N.length>0){const a=setInterval(()=>{J(r=>(r+1)%N.length)},3e3);return()=>clearInterval(a)}},[N.length]),g.useEffect(()=>{const a=y.filter(r=>r.category==="å®‰å…¨å»ºæž„æ ¸");if(y.filter(r=>r.category==="ç”Ÿå‘½æ»‹å…»æ ¸"),a.length>0){const r=setInterval(()=>{O(t=>(t+1)%a.length)},4e3);return()=>clearInterval(r)}},[y]),g.useEffect(()=>{const a=y.filter(r=>r.category==="ç”Ÿå‘½æ»‹å…»æ ¸");if(a.length>0){const r=setInterval(()=>{Q(t=>(t+1)%a.length)},4500);return()=>clearInterval(r)}},[y]);const Y=async()=>{V(!0),await ee(),X(a=>a+1)};return U?e.jsx("div",{className:"animate-pulse bg-gray-100 rounded-lg h-48"}):C?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(se,{className:"w-5 h-5 text-red-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-red-800",children:"æ•°æ®åŠ è½½å¤±è´¥"})]}),e.jsx("p",{className:"text-red-700 mb-4",children:C}),e.jsxs("button",{onClick:Y,className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"é‡æ–°åŠ è½½"]})]}):e.jsxs("div",{className:"flex gap-6",children:[e.jsxs(S.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},className:"w-1/3 bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg border border-white/20 p-6 hover:bg-white/90 transition-all duration-300",children:[e.jsx("div",{className:"mb-6",children:e.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"åŒ—æžæ˜Ÿ"})}),N.length>0?e.jsx(S.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"space-y-3",children:e.jsx("div",{className:"text-center py-6",children:e.jsx("h4",{className:"text-base font-semibold text-gray-800 px-1 leading-tight",children:N[D].name})})},D):e.jsx("div",{className:"text-center py-6",children:e.jsx("p",{className:"text-sm text-gray-500",children:"æš‚æ— ä»·å€¼è§‚æ•°æ®"})})]}),e.jsxs(S.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},className:"flex-1 bg-white/80 backdrop-blur-xl rounded-2xl shadow-lg border border-white/20 p-6 hover:bg-white/90 transition-all duration-300",children:[e.jsx("div",{className:"mb-6",children:e.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent",children:"æœ¬å­£/æœ¬å¹´æ ¸å¿ƒç›®æ ‡"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6 h-48",children:[e.jsxs("div",{className:"border rounded-lg p-4 bg-blue-50",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-800 mb-3 text-center",children:"ðŸ›¡ï¸ å®‰å…¨å»ºæž„æ ¸"}),(()=>{const a=y.filter(t=>t.category==="å®‰å…¨å»ºæž„æ ¸");if(a.length===0)return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"æš‚æ— ç›®æ ‡"});const r=a[_];return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"font-medium text-gray-800 leading-tight",children:r.name}),r.linkedProjects&&r.linkedProjects.length>0&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("p",{className:"font-medium",children:"å…³è”é¡¹ç›®:"}),e.jsx("div",{className:"space-y-1",children:r.linkedProjects.map((t,c)=>e.jsx("p",{className:"text-xs bg-blue-100 px-2 py-1 rounded",children:t},c))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"è¿›åº¦:"}),e.jsxs("span",{className:"font-medium",children:[r.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${r.progress}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"æœ¬å‘¨æŠ•å…¥:"}),e.jsxs("span",{className:"font-medium",children:[r.weeklyHours,"h"]})]})]}),a.length>1&&e.jsx("div",{className:"flex justify-center space-x-1 mt-3",children:a.map((t,c)=>e.jsx("div",{className:`w-2 h-2 rounded-full ${c===_?"bg-blue-500":"bg-gray-300"}`},c))})]})})()]}),e.jsxs("div",{className:"border rounded-lg p-4 bg-green-50",children:[e.jsx("h3",{className:"text-lg font-medium text-green-800 mb-3 text-center",children:"ðŸŒ± ç”Ÿå‘½æ»‹å…»æ ¸"}),(()=>{const a=y.filter(t=>t.category==="ç”Ÿå‘½æ»‹å…»æ ¸");if(a.length===0)return e.jsx("div",{className:"text-center text-gray-500 py-8",children:"æš‚æ— ç›®æ ‡"});const r=a[A];return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h4",{className:"font-medium text-gray-800 leading-tight",children:r.name}),r.linkedProjects&&r.linkedProjects.length>0&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:[e.jsx("p",{className:"font-medium",children:"å…³è”é¡¹ç›®:"}),e.jsx("div",{className:"space-y-1",children:r.linkedProjects.map((t,c)=>e.jsx("p",{className:"text-xs bg-green-100 px-2 py-1 rounded",children:t},c))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"è¿›åº¦:"}),e.jsxs("span",{className:"font-medium",children:[r.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${r.progress}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"æœ¬å‘¨æŠ•å…¥:"}),e.jsxs("span",{className:"font-medium",children:[r.weeklyHours,"h"]})]})]}),a.length>1&&e.jsx("div",{className:"flex justify-center space-x-1 mt-3",children:a.map((t,c)=>e.jsx("div",{className:`w-2 h-2 rounded-full ${c===A?"bg-green-500":"bg-gray-300"}`},c))})]})})()]})]})]})]})};export{oe as default};
