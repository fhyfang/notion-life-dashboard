import{j as e,m as g}from"./motion-CtNUML8-.js";import{r as c}from"./vendor-DJ1oPbzn.js";import{g as v}from"./index-B9mZRE9N.js";import{b as E,T as V,a as _}from"./icons-CbvDa_dU.js";const z=()=>{const[l,b]=c.useState([]),[w,D]=c.useState([]),[d,u]=c.useState(0),[I,y]=c.useState(!0);return c.useEffect(()=>{(async()=>{const S=(await v("价值观")).filter(s=>{var t,o;const r=((o=(t=s.properties.优先级)==null?void 0:t.select)==null?void 0:o.name)||"0分";return parseInt(r.replace("分",""))>=4}).map(s=>{var r,n,t,o,m,p,x,h;return{name:((n=(r=s.properties.价值观名称)==null?void 0:r.title[0])==null?void 0:n.plain_text)||"未命名",description:((o=(t=s.properties["正面行为 (Do's)"])==null?void 0:t.rich_text[0])==null?void 0:o.plain_text)||"",priority:parseInt(((x=(p=(m=s.properties.优先级)==null?void 0:m.select)==null?void 0:p.name)==null?void 0:x.replace("分",""))||"0"),icon:((h=s.icon)==null?void 0:h.emoji)||"🎯"}});b(S);const k=(await v("目标库")).filter(s=>{var n,t;const r=(t=(n=s.properties.状态)==null?void 0:n.status)==null?void 0:t.name;return r==="进行中"||r==="In Progress"}).slice(0,4).map(s=>{var r,n,t,o,m,p,x,h,f,j,N;return{name:((t=(n=(r=s.properties.理想状态)==null?void 0:r.title[0])==null?void 0:n.plain_text)==null?void 0:t.trim())||"未命名目标",linkedValues:((m=(o=s.properties.关联价值观)==null?void 0:o.relation)==null?void 0:m.map(C=>C.id))||[],progress:((x=(p=s.properties.目标进度)==null?void 0:p.rollup)==null?void 0:x.number)||0,weeklyHours:0,deadline:((f=(h=s.properties.截止日期)==null?void 0:h.date)==null?void 0:f.start)||"",status:((N=(j=s.properties.状态)==null?void 0:j.status)==null?void 0:N.name)||""}});D(k),y(!1)})().catch(()=>y(!1))},[]),c.useEffect(()=>{if(l.length>0){const a=setInterval(()=>{u(i=>(i+1)%l.length)},5e3);return()=>clearInterval(a)}},[l.length]),I?e.jsx("div",{className:"animate-pulse bg-gray-100 rounded-lg h-48"}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs(g.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},className:"lg:col-span-1 bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(E,{className:"w-5 h-5 text-indigo-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold",children:"我的价值观与北极星"})]}),l.length>0&&e.jsxs(g.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"space-y-3",children:[e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"text-4xl mb-3",children:l[d].icon}),e.jsx("h4",{className:"text-xl font-bold text-gray-800 mb-2",children:l[d].name}),e.jsx("p",{className:"text-sm text-gray-600 overflow-hidden",children:l[d].description})]}),e.jsx("div",{className:"flex justify-center space-x-2",children:l.map((a,i)=>e.jsx("button",{onClick:()=>u(i),className:`w-2 h-2 rounded-full transition-all ${i===d?"bg-indigo-600 w-6":"bg-gray-300 hover:bg-gray-400"}`},i))})]},d)]}),e.jsxs(g.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},className:"lg:col-span-3 bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(V,{className:"w-5 h-5 text-green-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold",children:"本季/本年核心目标"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map((a,i)=>e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.1},className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-800 flex-1",children:a.name}),e.jsxs("span",{className:"text-sm font-semibold text-green-600",children:[a.progress,"%"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-green-400 to-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${a.progress}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"w-3 h-3 mr-1"}),e.jsxs("span",{children:[a.weeklyHours,"h/周"]})]}),a.deadline&&e.jsxs("span",{children:["截止: ",new Date(a.deadline).toLocaleDateString("zh-CN")]})]})]})]},i))})]})]})};export{z as default};
