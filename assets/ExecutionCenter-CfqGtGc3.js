import{j as e,m as p}from"./motion-CtNUML8-.js";import{r as o}from"./vendor-DJ1oPbzn.js";import{g as h}from"./index-B9mZRE9N.js";import{A as G,C as H,c as I,a as T,d as P,B as Q,D as Y}from"./icons-CbvDa_dU.js";const K=()=>{const[g,C]=o.useState([]),[u,$]=o.useState([]),[d,j]=o.useState({mood:0,energy:0,sleep:0,meditation:0,exercise:0}),[y,E]=o.useState([]),[L,f]=o.useState(!0);o.useEffect(()=>{(async()=>{const M=(await h("è¡ŒåŠ¨åº“")).filter(s=>{var i,l,n,c;const r=(l=(i=s.properties.çŠ¶æ€)==null?void 0:i.status)==null?void 0:l.name,a=(c=(n=s.properties.æˆªæ­¢æ—¥æœŸ)==null?void 0:n.date)==null?void 0:c.start;return r!=="å·²å®Œæˆ"&&a}).map(s=>{var r,a,i,l,n,c,m,x,D,S;return{id:s.id,title:((a=(r=s.properties.è¡ŒåŠ¨æè¿°)==null?void 0:r.title[0])==null?void 0:a.plain_text)||"æœªå‘½åä»»åŠ¡",priority:parseInt(((l=(i=s.properties.ä¼˜å…ˆçº§)==null?void 0:i.select)==null?void 0:l.name)||"0"),deadline:((c=(n=s.properties.æˆªæ­¢æ—¥æœŸ)==null?void 0:n.date)==null?void 0:c.start)||"",status:((x=(m=s.properties.çŠ¶æ€)==null?void 0:m.status)==null?void 0:x.name)||"",type:((S=(D=s.properties.è¡ŒåŠ¨ç±»åž‹)==null?void 0:D.select)==null?void 0:S.name)||"å…¶ä»–"}}).sort((s,r)=>r.priority-s.priority);C(M);const _=(await h("æ¯æ—¥æ—¥å¿—")).filter(s=>{var a,i;const r=(i=(a=s.properties.æ—¥æœŸ)==null?void 0:a.date)==null?void 0:i.start;return r&&new Date(r).toDateString()===new Date().toDateString()}).map(s=>{var r,a,i,l,n,c,m,x;return{id:s.id,startTime:((a=(r=s.properties.å¼€å§‹æ—¶é—´)==null?void 0:r.date)==null?void 0:a.start)||"",endTime:((l=(i=s.properties.ç»“æŸæ—¶é—´)==null?void 0:i.date)==null?void 0:l.start)||"",activity:((c=(n=s.properties.æ´»åŠ¨åç§°)==null?void 0:n.title[0])==null?void 0:c.plain_text)||"",duration:((m=s.properties.å®žé™…æ—¶é•¿)==null?void 0:m.number)||0,valueScore:((x=s.properties.ä»·å€¼è¯„åˆ†)==null?void 0:x.number)||0}}).sort((s,r)=>new Date(r.startTime).getTime()-new Date(s.startTime).getTime());$(_);const b=await h("å¥åº·æ—¥è®°"),v=await h("æƒ…ç»ªè®°å½•"),k=await h("ç›®æ ‡åº“"),w=new Date().getFullYear(),z=Math.floor((new Date().getMonth()+3)/3),A=k.filter(s=>{var i,l,n,c;const r=(l=(i=s.properties.çŠ¶æ€)==null?void 0:i.status)==null?void 0:l.name,a=(c=(n=s.properties.æ—¶é—´è·¨åº¦)==null?void 0:n.select)==null?void 0:c.name;return(r==="è¿›è¡Œä¸­"||r==="In Progress")&&(a===`${w}å¹´`||a===`${w}Q${z}`||a==="æœ¬å¹´"||a==="æœ¬å­£"||a==="å­£åº¦ç›®æ ‡")}).map(s=>{var r,a,i,l,n,c;return{name:((a=(r=s.properties.ç†æƒ³çŠ¶æ€)==null?void 0:r.title[0])==null?void 0:a.plain_text)||"æœªå‘½åç›®æ ‡",progress:Math.round((((l=(i=s.properties.ç›®æ ‡è¿›åº¦)==null?void 0:i.rollup)==null?void 0:l.number)||0)*100),timeSpan:((c=(n=s.properties.æ—¶é—´è·¨åº¦)==null?void 0:n.select)==null?void 0:c.name)||""}}).slice(0,3);if(E(A),b.length>0){const s=b[0];j(r=>{var a,i,l;return{...r,sleep:((a=s.properties.ç¡çœ è¯„åˆ†)==null?void 0:a.number)||0,exercise:((i=s.properties.è¿åŠ¨è¯„åˆ†)==null?void 0:i.number)||0,meditation:((l=s.properties.å†¥æƒ³è¯„åˆ†)==null?void 0:l.number)||0}})}if(v.length>0){const s=v[0];j(r=>{var a,i;return{...r,mood:((a=s.properties.æƒ…ç»ªè¯„åˆ†)==null?void 0:a.number)||0,energy:((i=s.properties.ç²¾åŠ›æ°´å¹³)==null?void 0:i.number)||0}})}f(!1)})().catch(()=>f(!1))},[]);const B=t=>{console.log("Toggle task:",t)};return L?e.jsx("div",{className:"animate-pulse bg-gray-100 rounded-lg h-96"}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[e.jsxs(p.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},className:"lg:col-span-1 bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(G,{className:"w-5 h-5 text-blue-600 mr-2"}),"ä»Šæ—¥è¡ŒåŠ¨"]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:g.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"æš‚æ— ä»Šæ—¥ä»»åŠ¡"}):g.map(t=>e.jsxs(p.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex items-start space-x-3 p-2 hover:bg-gray-50 rounded-lg cursor-pointer",onClick:()=>B(t.id),children:[e.jsx("div",{className:"mt-1",children:t.status==="å·²å®Œæˆ"?e.jsx(H,{className:"w-5 h-5 text-green-500"}):e.jsx(I,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`text-sm ${t.status==="å·²å®Œæˆ"?"line-through text-gray-400":""}`,children:t.title}),e.jsxs("div",{className:"flex items-center mt-1 text-xs text-gray-500",children:[e.jsxs("span",{className:`px-2 py-0.5 rounded-full ${t.priority>=4?"bg-red-100 text-red-700":t.priority>=3?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-600"}`,children:["P",t.priority]}),e.jsx("span",{className:"ml-2",children:t.type})]})]})]},t.id))})]}),e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"lg:col-span-2 bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(T,{className:"w-5 h-5 text-green-600 mr-2"}),"æ—¥å¿—æµ"]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:u.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"ä»Šæ—¥è¿˜æœªå¼€å§‹è®°å½•"}):u.map(t=>e.jsx(p.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"border-l-4 border-green-500 pl-4 py-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-800",children:t.activity}),e.jsxs("div",{className:"flex items-center mt-1 text-sm text-gray-600",children:[e.jsx(T,{className:"w-3 h-3 mr-1"}),e.jsxs("span",{children:[new Date(t.startTime).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}),t.endTime&&` - ${new Date(t.endTime).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}`]}),e.jsx("span",{className:"mx-2",children:"â€¢"}),e.jsxs("span",{children:[t.duration,"åˆ†é’Ÿ"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-sm font-semibold text-green-600",children:["ä»·å€¼ ",t.valueScore,"/5"]})})]})},t.id))})]}),e.jsxs(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"lg:col-span-1 bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(P,{className:"w-5 h-5 text-red-600 mr-2"}),"ç”Ÿå‘½ä½“å¾"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ä»Šæ—¥å¿ƒæƒ…"}),e.jsxs("span",{className:"text-sm font-semibold",children:[d.mood,"/10"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-pink-400 to-pink-600 h-2 rounded-full",style:{width:`${d.mood*10}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"ä»Šæ—¥ç²¾åŠ›"}),e.jsxs("span",{className:"text-sm font-semibold",children:[d.energy,"/10"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-yellow-600 h-2 rounded-full",style:{width:`${d.energy*10}%`}})})]}),e.jsxs("div",{className:"border-t pt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-2",children:"ðŸ’¤"}),e.jsx("span",{children:"ç¡çœ è´¨é‡"})]}),e.jsxs("span",{className:"text-lg font-semibold text-blue-600",children:[d.sleep,"/10"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-2",children:e.jsx(Q,{className:"w-4 h-4 text-purple-600"})}),e.jsx("span",{children:"å†¥æƒ³è¯„åˆ†"})]}),e.jsxs("span",{className:"text-lg font-semibold text-purple-600",children:[d.meditation,"/10"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-2",children:e.jsx(Y,{className:"w-4 h-4 text-green-600"})}),e.jsx("span",{children:"è¿åŠ¨è¯„åˆ†"})]}),e.jsxs("span",{className:"text-lg font-semibold text-green-600",children:[d.exercise,"/10"]})]})]}),y.length>0&&e.jsxs("div",{className:"border-t pt-4 space-y-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"æ ¸å¿ƒç›®æ ‡"}),y.map((t,N)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("span",{className:"text-xs text-gray-600 flex-1 mr-2",children:t.name}),e.jsxs("span",{className:"text-xs font-semibold text-indigo-600",children:[t.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-gradient-to-r from-indigo-400 to-indigo-600 h-1.5 rounded-full",style:{width:`${t.progress}%`}})}),e.jsx("span",{className:"text-xs text-gray-500",children:t.timeSpan})]},N))]})]})]})]})};export{K as default};
