import{j as e,m as h}from"./motion-Nujmgg1Y.js";import{r as d}from"./vendor-DJ1oPbzn.js";import{g as f}from"./dataLoader-oWN11X4O.js";import{D,C as w,d as v,c as S,b as C}from"./icons-CYvmV9N1.js";const L=()=>{const[g,j]=d.useState([]),[p,y]=d.useState(!0),[N,b]=d.useState("");return d.useEffect(()=>{const a=new Date;b(a.toISOString().split("T")[0]),(async()=>{const u=["每日日志","健康日记","情绪记录","行动库"],i=[];for(const n of u)try{const l=await f(n),o=l.filter(x=>{var s,r;const t=(r=(s=x.properties.日期)==null?void 0:s.date)==null?void 0:r.start;return t?new Date(t).toDateString()===a.toDateString():!1});let m="";l.length>0&&(m=l.map(t=>{var s,r;return(r=(s=t.properties.日期)==null?void 0:s.date)==null?void 0:r.start}).filter(Boolean).sort((t,s)=>new Date(s).getTime()-new Date(t).getTime())[0]||""),i.push({database:n,totalRecords:l.length,todayRecords:o.length,latestDate:m,hasToday:o.length>0})}catch{i.push({database:n,totalRecords:0,todayRecords:0,latestDate:"",hasToday:!1})}j(i),y(!1)})()},[]),p?e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]})]})}):e.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(D,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold",children:"数据状态检查"})]}),e.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center text-blue-700",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),e.jsxs("span",{className:"font-medium",children:["当前日期：",N]})]})}),e.jsx("div",{className:"space-y-4",children:g.map((a,c)=>e.jsxs(h.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:c*.1},className:`p-4 rounded-lg border-2 ${a.hasToday?"border-green-200 bg-green-50":"border-yellow-200 bg-yellow-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:a.database}),a.hasToday?e.jsx(v,{className:"w-5 h-5 text-green-600"}):e.jsx(S,{className:"w-5 h-5 text-yellow-600"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"总记录数："}),e.jsx("span",{className:"font-medium",children:a.totalRecords})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"今日记录："}),e.jsx("span",{className:`font-medium ${a.todayRecords>0?"text-green-600":"text-red-600"}`,children:a.todayRecords})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-600",children:"最新记录日期："}),e.jsx("span",{className:"font-medium ml-1",children:a.latestDate?new Date(a.latestDate).toLocaleDateString("zh-CN"):"无数据"})]})]}),!a.hasToday&&a.latestDate&&e.jsxs("div",{className:"mt-3 p-2 bg-yellow-100 rounded text-sm text-yellow-800",children:[e.jsx(C,{className:"w-4 h-4 inline mr-1"}),"今日暂无记录，最新数据来自 ",new Date(a.latestDate).toLocaleDateString("zh-CN")]})]},a.database))}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"解决方案"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"• 如果今日暂无记录，请在Notion中添加今日的数据"}),e.jsx("li",{children:'• 确保数据库中的"日期"字段格式正确'}),e.jsx("li",{children:"• 检查Notion API同步是否正常工作"}),e.jsx("li",{children:"• 可以手动触发数据同步更新"})]})]})]})};export{L as default};
