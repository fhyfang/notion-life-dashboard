import{j as e}from"./motion-Nujmgg1Y.js";import{r as n}from"./vendor-DJ1oPbzn.js";import{g as p}from"./dataLoader-oWN11X4O.js";import{p as v,d as y,q as b}from"./icons-CYvmV9N1.js";const m={每日复盘:{displayName:"每日复盘",color:"#3B82F6"},人生主数据:{displayName:"人生主数据",color:"#10B981"},价值观:{displayName:"价值观",color:"#F59E0B"},价值观检验:{displayName:"价值观检验",color:"#EF4444"},目标库:{displayName:"目标库",color:"#8B5CF6"},项目库:{displayName:"项目库",color:"#06B6D4"},行动库:{displayName:"行动库",color:"#84CC16"},每日日志:{displayName:"每日日志",color:"#F97316"},情绪记录:{displayName:"情绪记录",color:"#EC4899"},健康日记:{displayName:"健康日记",color:"#6366F1"},注意力记录:{displayName:"注意力记录",color:"#14B8A6"},创造记录:{displayName:"创造记录",color:"#F59E0B"},互动记录:{displayName:"互动记录",color:"#8B5CF6"},财务记录:{displayName:"财务记录",color:"#10B981"},成长复盘:{displayName:"成长复盘",color:"#3B82F6"},欲望数据库:{displayName:"欲望数据库",color:"#F97316"},知识库:{displayName:"知识库",color:"#EF4444"},思维模型:{displayName:"思维模型",color:"#06B6D4"},关系网:{displayName:"关系网",color:"#84CC16"}},w=()=>{const[a,c]=n.useState([]),[h,x]=n.useState(!0);n.useEffect(()=>{(async()=>{x(!0);const t=Object.keys(m),g=t.map(l=>({name:l,displayName:m[l].displayName,status:"loading",recordCount:0}));c(g);for(const l of t)try{const d=await p(l);c(o=>o.map(r=>r.name===l?{...r,status:"success",recordCount:d.length}:r))}catch(d){c(o=>o.map(r=>r.name===l?{...r,status:"error",recordCount:0,error:d instanceof Error?d.message:"未知错误"}:r))}x(!1)})()},[]);const j=s=>{switch(s){case"loading":return e.jsx(b,{className:"w-5 h-5 text-blue-500 animate-spin"});case"success":return e.jsx(y,{className:"w-5 h-5 text-green-500"});case"error":return e.jsx(v,{className:"w-5 h-5 text-red-500"})}},i=a.filter(s=>s.status==="success").length,N=a.filter(s=>s.status==="error").length,u=a.reduce((s,t)=>s+t.recordCount,0);return e.jsx("div",{className:"max-w-6xl mx-auto p-6",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"数据库连接测试"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:a.length}),e.jsx("div",{className:"text-sm text-blue-600",children:"总数据库数"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i}),e.jsx("div",{className:"text-sm text-green-600",children:"连接成功"})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:N}),e.jsx("div",{className:"text-sm text-red-600",children:"连接失败"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u}),e.jsx("div",{className:"text-sm text-purple-600",children:"总记录数"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-4",children:"数据库详情"}),a.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-sm font-medium text-gray-600",children:t+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.displayName}),e.jsx("div",{className:"text-sm text-gray-500",children:s.name})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[s.status==="success"&&e.jsxs("div",{className:"text-sm text-gray-600",children:[s.recordCount," 条记录"]}),s.status==="error"&&s.error&&e.jsx("div",{className:"text-sm text-red-600 max-w-xs truncate",children:s.error}),j(s.status)]})]},s.name))]}),e.jsxs("div",{className:"mt-8 p-6 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:"用户提供的19个数据库连接"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsx("div",{children:"• 每日复盘"}),e.jsx("div",{children:"• 人生主数据"}),e.jsx("div",{children:"• 价值观"}),e.jsx("div",{children:"• 价值观检验"}),e.jsx("div",{children:"• 目标库"}),e.jsx("div",{children:"• 项目库"}),e.jsx("div",{children:"• 行动库"}),e.jsx("div",{children:"• 每日日志"}),e.jsx("div",{children:"• 情绪记录"}),e.jsx("div",{children:"• 健康日记"}),e.jsx("div",{children:"• 注意力记录"}),e.jsx("div",{children:"• 创造记录"}),e.jsx("div",{children:"• 互动记录"}),e.jsx("div",{children:"• 财务记录"}),e.jsx("div",{children:"• 成长复盘"}),e.jsx("div",{children:"• 欲望数据库"}),e.jsx("div",{children:"• 知识库"}),e.jsx("div",{children:"• 思维模型"}),e.jsx("div",{children:"• 关系网"})]})]}),!h&&e.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-blue-800",children:[e.jsx("strong",{children:"测试完成！"}),i===a.length?"所有数据库连接正常，可以正常调用数据。":`${i}/${a.length} 个数据库连接成功。`]})})]})})};export{w as default};
